(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{73:function(e,t,n){e.exports=n(85)},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(8),o=n(15),u=n.n(o),s=n(20),l=n(30),i=n(44),m=n(27),f=n(126),p=n(61),d=n.n(p),h=n(17),b=Object(h.a)(),v=n(128),E={apiUrl:"https://localhost:8443"},g=function(e){return e.text().then((function(t){var n=t&&JSON.parse(t);if(!e.ok){-1!==[401,403].indexOf(e.status)&&(O.logout(),window.location.reload(!0));var a=n&&n.message||e.statusText;return Promise.reject(a)}return n}))},w=new v.a(JSON.parse(localStorage.getItem("token"))),O={login:function(e,t){var n=new URLSearchParams;n.set("username",e),n.set("password",t);var a={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n};return fetch("".concat(E.apiUrl,"/login"),a).then(g).then((function(e){return localStorage.setItem("token",JSON.stringify(e.token)),localStorage.setItem("userName",JSON.stringify(e.userName)),w.next(e.token),e.token}))},logout:function(){return fetch("".concat(E.apiUrl,"/logout")).then((function(){localStorage.removeItem("token"),localStorage.removeItem("userName"),w.next(null)}))},currentToken:w.asObservable(),get currentTokenValue(){return w.value},getCurrentUserName:function(){return localStorage.getItem("userName")}},x=n(2),j=function(e){var t=e.component,n=Object(x.a)(e,["component"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return O.currentTokenValue?r.a.createElement(t,e):r.a.createElement(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},k=n(32),y=n(119),N=n(121),S=n(127),T=n(56),C=n.n(T),I=n(116),U=Object(I.a)((function(){return{container:{display:"flex",alignItems:"center"},button:{height:"auto",marginLeft:20}}})),J=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.values,c=U();return r.a.createElement("form",{onSubmit:t},r.a.createElement(y.a,{className:c.container},r.a.createElement(S.a,{className:"todo-text-field",name:"text",variant:"outlined",margin:"dense",value:a.text,onChange:n}),r.a.createElement(N.a,{className:c.button,variant:"contained",size:"large",type:"submit"},r.a.createElement(C.a,null),"Add")))},L=n(122),P=n(123),V=n(125),R=n(58),z=n.n(R),F=n(124),B=n(57),D=n.n(B),_=Object(I.a)((function(){return{card:{marginTop:20},deleteIcon:{marginLeft:"auto"}}})),A=function(e){var t=e.text,n=e.onRemove,a=_(),c=D()(a.card,"todo-item");return r.a.createElement(L.a,{className:c},r.a.createElement(P.a,null,r.a.createElement(F.a,{gutterBottom:!0},t)),r.a.createElement(V.a,null,r.a.createElement(f.a,{size:"small",onClick:n,className:a.deleteIcon},r.a.createElement(z.a,{className:a.icon}))))},G=function(){var e=Object(s.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URLSearchParams).set("text",t),(a=K("POST")).body=n,e.abrupt("return",fetch("".concat(E.apiUrl,"/todos"),a).then(g));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),q=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(E.apiUrl,"/todos"),K("GET")).then(g));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(s.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(E.apiUrl,"/todos/").concat(t),K("DELETE")).then(g));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),K=function(e){return function(e){var t=Object.assign({},e);return t.headers["x-access-token"]=O.currentTokenValue,t}({method:e,headers:{"Content-Type":"application/x-www-form-urlencoded"}})},M={saveTodo:G,deleteTodo:H,getTodos:q},Q=(n(83),function(){var e=Object(a.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(""),i=Object(l.a)(o,2),m=i[0],f=i[1],p=function(){var e=Object(s.a)(u.a.mark((function e(t,n){var a,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.resetForm,r=t.text,e.next=4,M.saveTodo(r);case 4:c=e.sent,f(c.data._id),a();case 7:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();Object(a.useEffect)((function(){h()}),[m]);var d=function(e){M.deleteTodo(e._id).then((function(e){f("".concat(m).concat(Date.now()))}))},h=Object(a.useCallback)(Object(s.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,M.getTodos();case 3:t=e.sent,c(t.data),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])}))),[]);return r.a.createElement(y.a,null,r.a.createElement(k.c,{initialValues:{text:""},render:function(e){return r.a.createElement(J,e)},onSubmit:p}),r.a.createElement(y.a,null,n.map((function(e){return r.a.createElement(A,{key:e.id,text:e.text,onRemove:d.bind(null,e)})}))))}),W=n(41),X=n(24),Y=n(59),Z=n(60),$=n(62),ee=(n(84),function(e){function t(e){var n;return Object(W.a)(this,t),n=Object(Y.a)(this,Object(Z.a)(t).call(this,e)),O.currentTokenValue&&n.props.history.push("/"),n}return Object($.a)(t,e),Object(X.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(k.c,{initialValues:{username:"",password:""},onSubmit:function(t,n){var a=t.username,r=t.password,c=n.setStatus,o=n.setSubmitting;c(),O.login(a,r).then((function(t){var n=(e.props.location.state||{from:{pathname:"/"}}).from;e.props.history.push(n)}),(function(e){o(!1),c(e)}))},render:function(e){var t=e.isSubmitting;return r.a.createElement(k.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(k.a,{name:"username",type:"text",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(k.a,{name:"password",type:"password",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},"Login")))}}))}}]),t}(r.a.Component)),te=function(){var e=Object(a.useState)(null),t=Object(l.a)(e,2),n=t[0],c=t[1];Object(a.useEffect)((function(){return O.currentToken.subscribe((function(e){c(e)})).unsubscribe()}),[]);var o=function(){var e=Object(s.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.logout();case 2:b.push("/login");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(i.a,{history:b},r.a.createElement("div",null,r.a.createElement("div",{className:"jumbotron"},n&&r.a.createElement("div",{style:{float:"right"}},r.a.createElement(f.a,{size:"small",onClick:o},r.a.createElement("span",null,O.getCurrentUserName()),r.a.createElement(d.a,null))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement(j,{exact:!0,path:"/",component:Q}),r.a.createElement("div",{style:{display:"flex",width:"100%",height:"calc(100vh - 100px)",alignItems:"center",justifyContent:"center"}},r.a.createElement(m.b,{path:"/login",component:ee}))))))))};Object(c.render)(r.a.createElement(te,null),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.e5c66e42.chunk.js.map