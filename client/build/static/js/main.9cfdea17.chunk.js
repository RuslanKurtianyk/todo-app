(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{73:function(e,t,n){e.exports=n(85)},83:function(e,t,n){},84:function(e,t,n){},85:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(8),c=n(20),u=n.n(c),l=n(33),s=n(32),i=n(44),m=n(26),f=n(126),p=n(61),d=n.n(p),h=n(16),b=Object(h.a)(),v=n(128),E={apiUrl:"https://localhost:443"},g=function(e){return e.text().then((function(t){var n=t&&JSON.parse(t);if(!e.ok){-1!==[401,403].indexOf(e.status)&&(x.logout(),window.location.reload(!0));var a=n&&n.message||e.statusText;return Promise.reject(a)}return n}))},w=new v.a(JSON.parse(localStorage.getItem("token"))),x={login:function(e,t){var n=new URLSearchParams;n.set("username",e),n.set("password",t);var a={method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n};return fetch("".concat(E.apiUrl,"/login"),a).then(g).then((function(e){return localStorage.setItem("token",JSON.stringify(e.token)),w.next(e.token),e.token}))},logout:function(){return fetch("".concat(E.apiUrl,"/logout")).then((function(){localStorage.removeItem("token"),w.next(null)}))},currentToken:w.asObservable(),get currentTokenValue(){return w.value}},O=n(2),j=function(e){var t=e.component,n=Object(O.a)(e,["component"]);return r.a.createElement(m.b,Object.assign({},n,{render:function(e){return x.currentTokenValue?r.a.createElement(t,e):r.a.createElement(m.a,{to:{pathname:"/login",state:{from:e.location}}})}}))},k=n(18),y=n(30),N=n(119),S=n(121),T=n(127),U=n(56),C=n.n(U),I=n(116),L=Object(I.a)((function(){return{container:{display:"flex",alignItems:"center"},button:{height:"auto",marginLeft:20}}})),P=function(e){var t=e.handleSubmit,n=e.handleChange,a=e.values,o=L();return r.a.createElement("form",{onSubmit:t},r.a.createElement(N.a,{className:o.container},r.a.createElement(T.a,{className:"todo-text-field",name:"text",variant:"outlined",margin:"dense",value:a.text,onChange:n}),r.a.createElement(S.a,{className:o.button,variant:"contained",size:"large",type:"submit"},r.a.createElement(C.a,null),"Add")))},V=n(122),J=n(123),R=n(125),z=n(58),F=n.n(z),B=n(124),A=n(57),D=n.n(A),q=Object(I.a)((function(){return{card:{marginTop:20},deleteIcon:{marginLeft:"auto"}}})),G=function(e){var t=e.text,n=e.onRemove,a=q(),o=D()(a.card,"todo-item");return r.a.createElement(V.a,{className:o},r.a.createElement(J.a,null,r.a.createElement(B.a,{gutterBottom:!0},t)),r.a.createElement(R.a,null,r.a.createElement(f.a,{size:"small",onClick:n,className:a.deleteIcon},r.a.createElement(F.a,{className:a.icon}))))},H=function(e){var t=Object.assign({},e);return t.headers["x-access-token"]=x.currentTokenValue,t},K=function(){var e=Object(l.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=new URLSearchParams).set("text",t),a=H({method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n}),e.abrupt("return",fetch("".concat(E.apiUrl,"/todos"),a).then(g));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(E.apiUrl,"/todos")).then(g));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Q={saveTodo:K,deleteTodo:function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("".concat(E.apiUrl,"/todos/").concat(t),{method:"DELETE"}).then(g));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),getTodos:M},W=(n(83),function(){var e=Object(a.useState)([]),t=Object(s.a)(e,2),n=t[0],o=t[1],c=function(e){o(n.filter((function(t){return t.id!==e})))};return r.a.createElement(N.a,null,r.a.createElement(y.c,{initialValues:{text:""},render:function(e){return r.a.createElement(P,e)},onSubmit:function(e,t){var a=t.resetForm,r=e.text;Q.saveTodo(r).then((function(){void 0!==r&&""!==r&&(o([].concat(Object(k.a)(n),[{id:n.length,text:r}])),a())}))}}),r.a.createElement(N.a,null,n.map((function(e){return r.a.createElement(G,{key:e.id,text:e.text,onRemove:c.bind(null,e.id)})}))))}),X=n(41),Y=n(23),Z=n(59),$=n(60),_=n(62),ee=(n(84),function(e){function t(e){var n;return Object(X.a)(this,t),n=Object(Z.a)(this,Object($.a)(t).call(this,e)),x.currentTokenValue&&n.props.history.push("/"),n}return Object(_.a)(t,e),Object(Y.a)(t,[{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement(y.c,{initialValues:{username:"",password:""},onSubmit:function(t,n){var a=t.username,r=t.password,o=n.setStatus,c=n.setSubmitting;o(),x.login(a,r).then((function(t){var n=(e.props.location.state||{from:{pathname:"/"}}).from;e.props.history.push(n)}),(function(e){c(!1),o(e)}))},render:function(e){var t=e.isSubmitting;return r.a.createElement(y.b,null,r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement(y.a,{name:"username",type:"text",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"password"},"Password"),r.a.createElement(y.a,{name:"password",type:"password",className:"form-control"})),r.a.createElement("div",{className:"form-group"},r.a.createElement("button",{type:"submit",className:"btn btn-primary",disabled:t},"Login")))}}))}}]),t}(r.a.Component)),te=function(){var e=Object(a.useState)(null),t=Object(s.a)(e,2),n=t[0],o=t[1];Object(a.useEffect)((function(){return x.currentToken.subscribe((function(e){o(e)})).unsubscribe()}),[]);var c=function(){var e=Object(l.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.logout();case 2:b.push("/login");case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return r.a.createElement(i.a,{history:b},r.a.createElement("div",null,r.a.createElement("div",{className:"jumbotron"},n&&r.a.createElement(f.a,{size:"small",onClick:c},r.a.createElement(d.a,null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-md-6 offset-md-3"},r.a.createElement(j,{exact:!0,path:"/",component:W}),r.a.createElement("div",{style:{display:"flex",width:"100%",height:"calc(100vh - 100px)",alignItems:"center",justifyContent:"center"}},r.a.createElement(m.b,{path:"/login",component:ee}))))))))};Object(o.render)(r.a.createElement(te,null),document.getElementById("root"))}},[[73,1,2]]]);
//# sourceMappingURL=main.9cfdea17.chunk.js.map